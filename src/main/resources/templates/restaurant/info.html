<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Yummy! 商家信息</title>
    <script th:src="@{/js/tool/jquery.js}"></script>
    <!--/*@thymesVar id="restaurant" type="com.kodomo.yummy.entity.Restaurant"*/-->
    <meta th:each="strategy:${restaurant.getRestaurantValidStrategyByAmount()}"
          th:content="${strategy.getGreaterThan()}+'-'+${strategy.getDiscount()}"
          name="strategy">
    <meta name="restaurantId" th:content="${restaurant.getRestaurantId()}">
    <style>
        .offering-div:hover {
            cursor: crosshair;
        }
    </style>
</head>
<body th:with="self=${session.restaurant}">
<!--/*@thymesVar id="restaurant" type="com.kodomo.yummy.entity.Restaurant"*/-->
<th:block th:if="${restaurant}==null">
    出错了
</th:block>
<th:block th:if="${restaurant}!=null">
    <!--餐厅登录-->
    <th:block th:if="${restaurant.getRestaurantId().equals(self)}">
        <th:block th:replace="restaurant/head"/>
    </th:block>

    <!--客户登录-->
    <!--/*@thymesVar id="customer" type="com.kodomo.yummy.entity.Customer"*/-->
    <th:block th:if="${customer}!=null">
        <th:block th:replace="customer/head"/>
        <div>
            <h4>地址</h4>
            <th:block th:if="${customer.getLocations().size()}==0">
                <p style="color: red">您当前没有填写地址信息, 请进入
                    <a th:href="@{/customer/info}">个人信息</a>
                    填写</p>
            </th:block>
            <ul>
                <li th:each="location:${customer.getLocations()}">
                    <label>
                        <!--/*@thymesVar id="locationId" type="java.lang.Integer"*/-->
                        <input type="radio" name="location" th:value="${location.getLocationId()}"
                               class="location-select-radio"
                               th:checked="${location.getLocationId().equals(locationId)}">
                        <th:block th:text="${location.getInfo()}"/>
                    </label>
                </li>
            </ul>
        </div>
        <!--黑线-->
        <div style="height: 2px;width: 100%;background: black"></div>
    </th:block>

    <h2 th:text="${restaurant.getName()}"></h2>

    <div>
        <div>
            <h4>满减优惠</h4>
            <div th:text="${restaurant.getRestaurantStrategyText()}">
            </div>
        </div>

        <!--黑线-->
        <div style="height: 2px;width: 100%;background: black"></div>

        <div>
            <h4>菜品信息</h4>
            <div style="display: flex">
                <div>
                    <ul>
                        <li>商品分类</li>
                        <li th:each="type:${restaurant.getOfferingTypeByOrder()}">
                            <label class="offering-type-select-label">
                                <input type="radio" class="offering-type-radio" name="type"
                                       th:value="${type.getOfferingTypeId()}">
                                <th:block th:text="${type.getName()}"/>
                            </label>
                        </li>
                        <li>
                            <label style="color: red">
                                <input type="radio" id="offering-non-type-radio" name="type">
                                无类别商品
                            </label>
                        </li>
                    </ul>
                </div>
                <div style="background: black;width: 2px;height: auto; margin: 10px"></div>
                <div>
                    <div th:each="offering:${restaurant.getValidOffering()}"
                         style="display: none; background: #d3d3d3 ;min-width: 200px; width: auto; margin: 10px"
                         class="offering-div"
                         th:id="${offering.isNonTyped()?'non':offering.getOfferingId()+'-'+offering.getOfferingTypeJoinBy('-')}"
                         th:value="${offering.getOfferingId()}">
                        <div style="display: flex;justify-content: space-around">
                            <div><h3 th:text="${offering.getName()}" class="offering-name-h3"></h3></div>
                            <div><h3 th:text="${offering.getPrice()}"
                                     class="offering-price-h3"></h3>
                            </div>
                        </div>
                        <div><label th:text="${offering.getNote()}" style="color: #333333"></label></div>
                    </div>
                </div>
            </div>
        </div>

        <th:block th:if="${customer}!=null">
            <div style="position: absolute;bottom: 0;width: 100%;">
                <button id="offering-selected-toggle-button" style="width: 100%">↓</button>
                <div style="background: black;min-height: 100px;color: white"
                     id="offering-selected-div">
                    <h3>已选:</h3>
                    <table id="offering-selected-table">

                    </table>
                    <button id="offering-submit-button">提交订单</button>
                    <span>总价: </span>
                    <span id="offering-total-before-price-span" style="text-decoration: line-through"></span>
                    <span id="offering-total-price-span">0</span>
                    <span>元</span>
                    <span style="color: red" id="offering-submit-info"></span>
                </div>
            </div>
        </th:block>
    </div>
</th:block>

<script th:src="@{/js/restaurantInfo.js}"></script>
</body>
</html>